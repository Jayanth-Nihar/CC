<!-- auth.html -->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>CampusConnect | Sign In / Sign Up</title>
	<link rel="stylesheet" href="styles.css"/>
</head>
<body>
	<!-- Simple header for auth page -->
	<div class="auth-header">
		<a href="index.html" class="brand">
			<div class="brand-logo">CC</div>
			<div class="brand-text">CampusConnect</div>
		</a>
	</div>

	<div class="auth-wrap">
		<div class="auth-card">
			<div class="auth-side">
				<h2>Welcome to CampusConnect</h2>
				<p class="small">Build your network. Learn faster. Join teams. Speak freely.</p>
				<ul class="small">
					<li>Junior‚ÄìSenior‚ÄìAlumni onboarding</li>
					<li>Recommendations by skills & interests</li>
					<li>Safe, moderated anonymous chat</li>
				</ul>
			</div>
			<div class="auth-form">
				<div class="tabs">
					<button class="tab" id="tab-signup">Sign Up</button>
					<button class="tab" id="tab-signin">Sign In</button>
				</div>

				<form id="signup-form">
					<div class="form-grid">
						<div class="form-row">
							<label>Full Name</label>
							<input type="text" id="su-name" placeholder="Your name" required/>
						</div>
						<div class="form-row">
							<label>Email</label>
							<input type="email" id="su-email" placeholder="you@college.edu" required/>
						</div>
						<div class="form-row">
							<label>Password</label>
							<div class="password-input-container">
								<input type="password" id="su-pass" placeholder="Min 6 characters" required minlength="6"/>
								<button type="button" class="password-toggle" id="su-pass-toggle">üëÅÔ∏è</button>
							</div>
						</div>
						<div class="form-row">
							<label>Role</label>
							<select id="su-role" required>
								<option value="">Select</option>
								<option>Junior</option>
								<option>Senior</option>
								<option>Alumni</option>
							</select>
						</div>
						<div class="form-row">
							<label>Year of Study</label>
							<select id="su-year" required>
								<option value="">Select</option>
								<option>I</option><option>II</option><option>III</option><option>IV</option>
							</select>
						</div>
						<div class="form-row">
							<label>Stream</label>
							<select id="su-stream" required>
								<option value="">Select</option>
								<option>CSE</option><option>IT</option><option>AIML</option><option>DS</option>
								<option>Cybersecurity</option><option>EEE</option><option>ECE</option>
								<option>Mechanical</option><option>Civil</option>
							</select>
						</div>
						<div class="form-row" style="grid-column:1/-1">
							<label>Interests (comma separated)</label>
							<input type="text" id="su-interests" placeholder="e.g. Python, WebDev Frontend, Databases, Music, Dance, Sports, Literature"/>
							<div class="tag-hint">Tip: include programming languages, AI/ML, frontend/backend, DB, or non-tech interests.</div>
						</div>
						<div class="form-row" style="grid-column:1/-1">
							<label>CAPTCHA Verification</label>
							<div class="captcha-container">
								<div class="captcha-display" id="captcha-display"></div>
								<input type="text" id="su-captcha" placeholder="Enter the code above" required/>
								<button type="button" class="btn ghost" id="refresh-captcha">üîÑ Refresh</button>
							</div>
						</div>
					</div>
					<div class="form-actions">
						<div class="help">By signing up, you agree to our community guidelines.</div>
						<button class="btn solid" type="submit">Create Account</button>
					</div>
					<hr class="sep"/>
				</form>

				<form id="signin-form" style="display:none">
					<div class="form-grid">
						<div class="form-row" style="grid-column:1/-1">
							<label>Email</label>
							<input type="email" id="si-email" placeholder="you@college.edu" required/>
						</div>
						<div class="form-row" style="grid-column:1/-1">
							<label>Password</label>
							<div class="password-input-container">
								<input type="password" id="si-pass" placeholder="Your password" required/>
								<button type="button" class="password-toggle" id="si-pass-toggle">üëÅÔ∏è</button>
							</div>
						</div>
					</div>
					<div class="form-actions">
						<a class="small" href="#">Forgot password?</a>
						<button class="btn solid" type="submit">Sign In</button>
					</div>
				</form>

				<p class="small">After sign in, you'll be redirected to the home page to explore all features.</p>
			</div>
		</div>


	</div>

	<script src="script.js"></script>
	<script>
	// CAPTCHA functionality
	let currentCaptcha = '';
	
	function generateCaptcha() {
		const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
		let captcha = '';
		for (let i = 0; i < 6; i++) {
			captcha += chars.charAt(Math.floor(Math.random() * chars.length));
		}
		currentCaptcha = captcha;
		
		const display = document.getElementById('captcha-display');
		if (display) {
			display.textContent = captcha;
			// Remove inline styles to use CSS variables for dark mode compatibility
			display.style.fontFamily = '';
			display.style.fontSize = '';
			display.style.fontWeight = '';
			display.style.letterSpacing = '';
			display.style.padding = '';
			display.style.backgroundColor = '';
			display.style.border = '';
			display.style.borderRadius = '';
			display.style.textAlign = '';
			display.style.userSelect = '';
		}
	}
	
	// Generate CAPTCHA on page load
	generateCaptcha();
	
	// Refresh CAPTCHA button
	document.getElementById('refresh-captcha').addEventListener('click', generateCaptcha);
	
	// Password toggle functionality
	function setupPasswordToggle(toggleId, inputId) {
		const toggle = document.getElementById(toggleId);
		const input = document.getElementById(inputId);
		
		if (toggle && input) {
			toggle.addEventListener('click', () => {
				if (input.type === 'password') {
					input.type = 'text';
					toggle.textContent = 'üôà';
				} else {
					input.type = 'password';
					toggle.textContent = 'üëÅÔ∏è';
				}
			});
		}
	}
	
	// Setup password toggles
	setupPasswordToggle('su-pass-toggle', 'su-pass');
	setupPasswordToggle('si-pass-toggle', 'si-pass');
	
	// Tabs and deep-link
	const tabSignup=document.getElementById('tab-signup');
	const tabSignin=document.getElementById('tab-signin');
	const formSignup=document.getElementById('signup-form');
	const formSignin=document.getElementById('signin-form');
	function setTab(mode){
		const isUp=mode==='signup';
		formSignup.style.display=isUp?'block':'none';
		formSignin.style.display=isUp?'none':'block';
		tabSignup.classList.toggle('active',isUp);
		tabSignin.classList.toggle('active',!isUp);
		location.hash=isUp?'#signup':'#signin';
	}
	tabSignup.onclick=()=>setTab('signup');
	tabSignin.onclick=()=>setTab('signin');
	if(location.hash==='#signin'){ setTab('signin'); } else { setTab('signup'); }

	// Demo signup: store user in localStorage (NOT for production)
	formSignup.addEventListener('submit',e=>{
		e.preventDefault();
		
		// CAPTCHA validation
		const captchaInput = document.getElementById('su-captcha').value.trim().toUpperCase();
		if (captchaInput !== currentCaptcha) {
			alert('CAPTCHA verification failed. Please try again.');
			generateCaptcha();
			document.getElementById('su-captcha').value = '';
			return;
		}
		
		const user={
			name:document.getElementById('su-name').value.trim(),
			email:document.getElementById('su-email').value.trim().toLowerCase(),
			password:document.getElementById('su-pass').value,
			role:document.getElementById('su-role').value,
			year:document.getElementById('su-year').value,
			stream:document.getElementById('su-stream').value,
			interests:document.getElementById('su-interests').value.split(',').map(s=>s.trim()).filter(Boolean),
			createdAt:Date.now()
		};
		const users=JSON.parse(localStorage.getItem('gm_users')||'[]');
		if(users.some(u=>u.email===user.email)){ alert('Account already exists. Please sign in.'); setTab('signin'); return; }
		users.push(user);
		localStorage.setItem('gm_users',JSON.stringify(users));
		localStorage.setItem('gm_current',user.email);
		alert('Account created! Redirecting to home page.');
		window.location.href='index.html';
	});

	// Demo signin: check credentials from localStorage
	formSignin.addEventListener('submit',e=>{
		e.preventDefault();
		const email=document.getElementById('si-email').value.trim().toLowerCase();
		const pass=document.getElementById('si-pass').value;
		const users=JSON.parse(localStorage.getItem('gm_users')||'[]');
		const found=users.find(u=>u.email===email && u.password===pass);
		if(!found){ alert('Invalid credentials.'); return; }
		localStorage.setItem('gm_current',found.email);
		alert('Welcome back! Redirecting to home page.');
		window.location.href='index.html';
	});
	</script>
</body>
</html>